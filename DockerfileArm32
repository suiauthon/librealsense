FROM ubuntu:16.04

ARG docker_user_uid=0
ARG docker_user_gid=0

WORKDIR /realsense

RUN groupadd \
    --gid $docker_user_gid docker_group && \
    useradd \
    --create-home \
    --shell /bin/bash \
    --uid $docker_user_uid \
    --gid $docker_user_gid \
    docker_user && \
	sed -i "s/^deb /deb [arch=amd64] /g" /etc/apt/sources.list && \
    echo "\
    deb [arch=armhf] http://ports.ubuntu.com/ xenial main restricted\n \
    deb [arch=armhf] http://ports.ubuntu.com/ xenial-updates main restricted\n \
    deb [arch=armhf] http://ports.ubuntu.com/ xenial universe\n \
    deb [arch=armhf] http://ports.ubuntu.com/ xenial-updates universe" \
    >> /etc/apt/sources.list && \
    dpkg --add-architecture armhf && \
    apt-get update && \
    apt-get install \
	--no-install-recommends \
	--assume-yes \
    gcc-arm-linux-gnueabihf \
	g++-arm-linux-gnueabihf \
    clang \
	cmake \
    libglfw3-dev:armhf \
	libgtk-3-dev:armhf \
	libusb-1.0-0-dev:armhf \
    gcc \
	make \
	libelf-dev \
	dkms \
	shim-signed \
	openssl \
	sudo && \
	echo 'docker_user ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers
	
USER $docker_user_uid:$docker_user_gid